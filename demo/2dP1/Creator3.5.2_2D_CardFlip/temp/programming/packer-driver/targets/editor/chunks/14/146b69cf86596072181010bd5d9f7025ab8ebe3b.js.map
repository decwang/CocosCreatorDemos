{"version":3,"sources":["file:///Users/mu/work/gitee/CocosCreatorDemos/demo/2dP1/Creator3.5.2_2D_CardFlip/assets/scripts/CardFlip.ts"],"names":["_decorator","Node","Component","Button","Color","Sprite","DEV","TweenUtil","ccclass","property","CardFlip","displayName","type","button","frontColor","WHITE","backColor","GRAY","onLoad","init","registerEvent","start","reset","onDestroy","unregisterEvent","flipBtn","on","EventType","TOUCH_END","onFlipBtnClick","off","getComponent","addComponent","spf","card","color","setButtonState","interactable","flip","equals"],"mappings":"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","sourcesContent":["import { _decorator, Node, Component, Button, Color, Sprite } from \"cc\";\nimport { DEV } from \"cc/env\";\nimport TweenUtil from \"./TweenUtil\";\n\nconst { ccclass, property } = _decorator;\n\n/**\n * 卡片翻转\n * @version 20210320\n */\n@ccclass('CardFlip')\nexport default class CardFlip extends Component {\n\n    @property({ displayName: DEV && '卡片', type: Node })\n    protected card: Node = null;\n\n    @property({ displayName: DEV && '翻转按钮', type: Node })\n    protected flipBtn: Node = null;\n\n    /** 按钮组件 */\n    protected button: Button = null;\n\n    /** 正面颜色 */\n    protected readonly frontColor: Color = Color.WHITE;\n\n    /** 背面颜色 */\n    protected readonly backColor: Color = Color.GRAY;\n\n    protected onLoad() {\n        this.init();\n        this.registerEvent();\n    }\n\n    protected start() {\n        this.reset();\n    }\n\n    protected onDestroy() {\n        this.unregisterEvent();\n    }\n\n    /**\n     * 注册事件\n     */\n    protected registerEvent() {\n        this.flipBtn.on(Node.EventType.TOUCH_END, this.onFlipBtnClick, this);\n    }\n\n    /**\n     * 反注册事件\n     */\n    protected unregisterEvent() {\n        this.flipBtn.off(Node.EventType.TOUCH_END, this.onFlipBtnClick, this);\n    }\n\n    /**\n     * 初始化\n     */\n    protected init() {\n        this.button = this.flipBtn.getComponent(Button) || this.flipBtn.addComponent(Button);\n    }\n\n    /**\n     * 重置\n     */\n    protected reset() {\n        let spf = this.card.getComponent(Sprite);\n        spf.color = this.frontColor;\n        this.setButtonState(true);\n    }\n\n    /**\n     * 翻转按钮点击回调\n     */\n    protected async onFlipBtnClick() {\n        if (!this.button.interactable) return;\n        this.setButtonState(false);\n        await TweenUtil.flip(this.card, 2, 1, () => {\n            let spf = this.card.getComponent(Sprite);\n            if (spf.color.equals(this.frontColor)) {\n                spf.color = this.backColor;\n            } else {\n                spf.color = this.frontColor;\n            }\n        });\n        this.setButtonState(true);\n    }\n\n    /**\n     * 设置按钮状态\n     * @param interactable 是否可点击\n     */\n    protected setButtonState(interactable: boolean) {\n        this.button.interactable = interactable;\n        let spf = this.flipBtn.getComponent(Sprite);\n        spf.color = interactable ? Color.WHITE : Color.GRAY;\n    }\n\n}\n"]}