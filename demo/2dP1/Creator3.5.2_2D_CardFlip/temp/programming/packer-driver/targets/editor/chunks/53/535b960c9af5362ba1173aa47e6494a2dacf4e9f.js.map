{"version":3,"sources":["file:///Users/mu/work/gitee/CocosCreatorDemos/demo/2dP1/Creator3.5.2_2D_CardFlip/assets/scripts/ScreenAdapter.ts"],"names":["_decorator","Component","view","Canvas","EventManager","ccclass","executionOrder","help","menu","ScreenAdapter","onLoad","init","onEnable","adapt","setResizeCallback","onResize","emit","winSize","cc","screenRatio","width","height","designResolution","instance","designRatio","setFitWidth","setFitHeight","canvas","fitHeight","fitWidth"],"mappings":";;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;;AAG/BC,MAAAA,Y;;;;;;;OAFD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA,cAAX;AAA2BC,QAAAA,IAA3B;AAAiCC,QAAAA;AAAjC,O,GAA0CR,U;;yBAY3BS,a,KATrB;AACA;AACA;AACA;AACA;AACA;aAECJ,OAAO,CAAC,eAAD,C,UACPC,cAAc,CAAC,CAAC,CAAF,C,UAAKC,IAAI,CAAC,8EAAD,C,UAAiFC,IAAI,CAAC,0BAAD,C,6DAD7G,MAEqBC,aAFrB,SAE2CR,SAF3C,CAEqD;AACrD;AACA;AACA;AACcS,QAAAA,MAAM,GAAG;AACf,eAAKC,IAAL;AACH,SANgD,CAOrD;AACA;AACA;;;AACcC,QAAAA,QAAQ,GAAG;AACjB,eAAKC,KAAL;AACH,SAZgD,CAarD;AACA;AACA;;;AACcF,QAAAA,IAAI,GAAG;AACrB;AACQT,UAAAA,IAAI,CAACY,iBAAL,CAAuB,MAAM,KAAKC,QAAL,EAA7B;AACH,SAnBgD,CAoBrD;AACA;AACA;;;AACcA,QAAAA,QAAQ,GAAG;AACzB;AACA;AACQ;AAAA;AAAA,4CAAaC,IAAb,CAAkB,aAAlB,EAHiB,CAIzB;;AACQ,eAAKH,KAAL;AACH,SA7BgD,CA8BrD;AACA;AACA;;;AACcA,QAAAA,KAAK,GAAG;AACtB;AACQ,gBAAMI,OAAO,GAAGC,EAAE,CAACD,OAAnB;AAAA,gBACAE,WAAW,GAAGF,OAAO,CAACG,KAAR,GAAgBH,OAAO,CAACI,MADtC,CAFc,CAItB;;AACQ,gBAAMC,gBAAgB,GAAGJ,EAAE,CAACf,MAAH,CAAUoB,QAAV,CAAmBD,gBAA5C;AAAA,gBACAE,WAAW,GAAGF,gBAAgB,CAACF,KAAjB,GAAyBE,gBAAgB,CAACD,MADxD,CALc,CAOtB;;AACQ,cAAIF,WAAW,IAAI,CAAnB,EAAsB;AAC9B;AACQ,gBAAIA,WAAW,IAAIK,WAAnB,EAAgC;AAChC,mBAAKC,WAAL;AACC,aAFD,MAEO;AACf;AACA;AACQ,mBAAKC,YAAL;AACC;AACA,WATD,MASO;AACf;AACQ,iBAAKA,YAAL;AACC;AACJ,SAtDgD,CAuDrD;AACA;AACA;;;AACcA,QAAAA,YAAY,GAAG;AACrB,gBAAMC,MAAM,GAAGxB,MAAM,CAACoB,QAAtB;AACAI,UAAAA,MAAM,CAACC,SAAP,GAAmB,IAAnB;AACAD,UAAAA,MAAM,CAACE,QAAP,GAAkB,KAAlB;AACH,SA9DgD,CA+DrD;AACA;AACA;;;AACcJ,QAAAA,WAAW,GAAG;AACpB,gBAAME,MAAM,GAAGxB,MAAM,CAACoB,QAAtB;AACAI,UAAAA,MAAM,CAACC,SAAP,GAAmB,KAAnB;AACAD,UAAAA,MAAM,CAACE,QAAP,GAAkB,IAAlB;AACH;;AAtEgD,O","sourcesContent":["import { _decorator, Component, view, Canvas, director, game } from 'cc';\r\nconst { ccclass, executionOrder, help, menu } = _decorator;\r\n\r\nimport EventManager from \"./EventManager\";\r\n// /**\r\n// * 屏幕适配组件\r\n// * @author 陈皮皮 (ifaswind)\r\n// * @version 20210504\r\n// * @see ScreenAdapter.ts https://gitee.com/ifaswind/eazax-ccc/blob/master/components/ScreenAdapter.ts\r\n// */\r\n\r\n@ccclass('ScreenAdapter')\r\n@executionOrder(-1)@help('https://gitee.com/ifaswind/eazax-ccc/blob/master/components/ScreenAdapter.ts')@menu('eazax/其他组件/ScreenAdapter')\r\nexport default class ScreenAdapter extends Component {\r\n// /**\r\n// * 生命周期：加载\r\n// */\r\n    protected onLoad() {\r\n        this.init();\r\n    }\r\n// /**\r\n// * 生命周期：组件启用\r\n// */\r\n    protected onEnable() {\r\n        this.adapt();\r\n    }\r\n// /**\r\n// * 初始化\r\n// */\r\n    protected init() {\r\n// // 设置游戏窗口变化的回调（仅 Web 平台有效）\r\n        view.setResizeCallback(() => this.onResize());\r\n    }\r\n// /**\r\n// * 窗口变化回调\r\n// */\r\n    protected onResize() {\r\n// // 由于 setResizeCallback 只能设置一个回调\r\n// // 使用事件系统发送一个特定事件，让其他组件也可以监听到窗口变化\r\n        EventManager.emit('view-resize');\r\n// // 适配\r\n        this.adapt();\r\n    }\r\n// /**\r\n// * 适配\r\n// */\r\n    protected adapt() {\r\n// // 实际屏幕比例\r\n        const winSize = cc.winSize,\r\n        screenRatio = winSize.width / winSize.height;\r\n// // 设计比例\r\n        const designResolution = cc.Canvas.instance.designResolution,\r\n        designRatio = designResolution.width / designResolution.height;\r\n// // 判断实际屏幕宽高比\r\n        if (screenRatio <= 1) {\r\n// // 此时屏幕高度大于宽度\r\n        if (screenRatio <= designRatio) {\r\n        this.setFitWidth();\r\n        } else {\r\n// // 此时实际屏幕比例大于设计比例\r\n// // 为了保证纵向的游戏内容不受影响，应使用 fitHeight 模式\r\n        this.setFitHeight();\r\n        }\r\n        } else {\r\n// // 此时屏幕高度小于宽度\r\n        this.setFitHeight();\r\n        }\r\n    }\r\n// /**\r\n// * 适配高度模式\r\n// */\r\n    protected setFitHeight() {\r\n        const canvas = Canvas.instance;\r\n        canvas.fitHeight = true;\r\n        canvas.fitWidth = false;\r\n    }\r\n// /**\r\n// * 适配宽度模式\r\n// */\r\n    protected setFitWidth() {\r\n        const canvas = Canvas.instance;\r\n        canvas.fitHeight = false;\r\n        canvas.fitWidth = true;\r\n    }\r\n}\r\n"]}