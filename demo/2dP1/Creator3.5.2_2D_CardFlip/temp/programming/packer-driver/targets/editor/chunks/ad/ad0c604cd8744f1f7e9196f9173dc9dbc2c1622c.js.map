{"version":3,"sources":["file:///Users/mu/work/gitee/CocosCreatorDemos/demo/2dP1/Creator3.5.2_2D_CardFlip/assets/scripts/ResPopup.ts"],"names":["_decorator","Node","Prefab","instantiate","PopupBase","ResPopupItem","ccclass","property","ResPopup","items","path","onLoad","registerEvent","onDestroy","unregisterEvent","closeBtn","on","EventType","TOUCH_END","onCloseBtnClick","off","updateDisplay","options","existedItems","optionItems","filter","v","name","url","count","Math","max","length","i","node","item","setParent","content","getComponent","set","active","push","hide"],"mappings":"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","sourcesContent":["import { _decorator, Node, Prefab, instantiate } from 'cc';\nconst { ccclass, property } = _decorator;\n\nimport PopupBase from \"./PopupBase\";\nimport ResPopupItem from \"./ResPopupItem\";\n\n/**\n * 资源弹窗选项类型\n */\nexport type ResPopupOptions = {\n    items: {\n        name: string;\n        url: string\n    }[];\n}\n\n/**\n * 资源展示弹窗\n */\n@ccclass('ResPopup')\nexport default class ResPopup extends PopupBase<ResPopupOptions> {\n    @property(Node)\n    protected closeBtn: Node | null = null;\n    @property(Node)\n    protected content: Node | null = null;\n    @property(Prefab)\n    protected item: Prefab | null = null;\n\n    /**\n     * 物体\n     */\n    protected items: ResPopupItem[] = [];\n\n    /**\n     * 资源弹窗路径\n     */\n    public static get path() {\n        return 'prefabs/ResPopup';\n    }\n\n    /**\n     * 生命周期：加载\n     */\n    protected onLoad() {\n        this.registerEvent();\n    }\n\n    /**\n     * 生命周期：销毁\n     */\n    protected onDestroy() {\n        this.unregisterEvent();\n    }\n\n    /**\n     * 注册事件\n     */\n    protected registerEvent() {\n        this.closeBtn.on(Node.EventType.TOUCH_END, this.onCloseBtnClick, this);\n    }\n\n    /**\n     * 反注册事件\n     */\n    protected unregisterEvent() {\n        this.closeBtn.off(Node.EventType.TOUCH_END, this.onCloseBtnClick, this);\n    }\n\n    /**\n     * 更新显示\n     * @param options\n     */\n    protected updateDisplay(options: ResPopupOptions) {\n        const existedItems = this.items,\n        optionItems = options.items.filter((v) => (v.name !== '' || v.url !== '')),\n        count = Math.max(optionItems.length, existedItems.length);\n        for (let i = 0; i < count; i++) {\n            // 新生成\n            if (optionItems[i] && !existedItems[i]) {\n                // 生成节点\n                const node = instantiate(this.item);\n                node.setParent(this.content);\n                // 设置组件\n                const item = node.getComponent(ResPopupItem);\n                item.set(optionItems[i].name, optionItems[i].url);\n                item.node.active = true;\n                existedItems.push(item);\n            }\n            // 复用\n            else if (optionItems[i] && existedItems[i]) {\n                // 复用组件\n                const item = existedItems[i];\n                item.set(optionItems[i].name, optionItems[i].url);\n                item.node.active = true;\n            }\n            // 隐藏\n            else {\n                // 隐藏节点\n                existedItems[i].node.active = false;\n            }\n        }\n    }\n\n    /**\n     * 关闭按钮点击回调\n     */\n    protected onCloseBtnClick() {\n        this.hide();\n    }\n}"]}