{"version":3,"sources":["file:///Users/mu/work/gitee/CocosCreatorDemos/demo/3d/Creator3.5.1_3D_DynamicMesh/assets/res/dynamicMesh.ts"],"names":["_decorator","Component","MeshRenderer","utils","gfx","ccclass","property","DynamicMesh","start","onBtnChangeMesh","console","log","mr","mesh","reset","genMesh","geo","primitiveMode","PrimitiveMode","TRIANGLE_STRIP","positions","colors","normals","attributes","Attribute","AttributeName","ATTR_POSITION","Format","RGB32F","ATTR_COLOR","RGBA32F","ATTR_NORMAL","indices","createMesh","undefined","calculateBounds"],"mappings":";;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,Y,OAAAA,Y;AAA0BC,MAAAA,K,OAAAA,K;AAA8BC,MAAAA,G,OAAAA,G;;;;;;;OACxF;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;6BAIjBO,W,WADZF,OAAO,CAAC,aAAD,C,UAGHC,QAAQ,CAACJ,YAAD,C,2BAHb,MACaK,WADb,SACiCN,SADjC,CAC2C;AAAA;AAAA;;AAAA;AAAA;;AAKvCO,QAAAA,KAAK,GAAI,CACR;;AAEDC,QAAAA,eAAe,GAAG;AACdC,UAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ;;AACA,cAAI,QAAQ,KAAKC,EAAjB,EAAqB;AACjB;AACH;;AACD,cAAIC,IAAI,GAAG,KAAKD,EAAL,CAAQC,IAAnB;AACAA,UAAAA,IAAI,QAAJ,YAAAA,IAAI,CAAEC,KAAN,CAAY,KAAKC,OAAL,EAAZ;AACA,eAAKH,EAAL,CAAQC,IAAR,GAAeA,IAAf;AACH;;AAEDE,QAAAA,OAAO,GAAqB;AACxB,cAAIC,GAAyB,GAAG;AAC5BC,YAAAA,aAAa,EAAEb,GAAG,CAACc,aAAJ,CAAkBC,cADL;AAE5BC,YAAAA,SAAS,EAAE,CACP,CAAC,CADM,EACF,CADE,EACE,CADF,EAEP,CAAC,CAFM,EAEH,CAAC,CAFE,EAEE,CAFF,EAGN,CAHM,EAGH,CAAC,CAHE,EAGE,CAHF,EAIN,CAJM,EAIF,CAJE,EAIE,CAJF,EAMN,CANM,EAMF,CANE,EAMC,CAAC,CANF,EAON,CAPM,EAOH,CAAC,CAPE,EAOC,CAAC,CAPF,EAQP,CAAC,CARM,EAQH,CAAC,CARE,EAQC,CAAC,CARF,EASP,CAAC,CATM,EASF,CATE,EASC,CAAC,CATF,EAWN,CAXM,EAWF,CAXE,EAWE,CAXF,EAYN,CAZM,EAYH,CAAC,CAZE,EAYE,CAZF,EAaN,CAbM,EAaH,CAAC,CAbE,EAaC,CAAC,CAbF,EAcN,CAdM,EAcF,CAdE,EAcC,CAAC,CAdF,EAgBP,CAAC,CAhBM,EAgBF,CAhBE,EAgBC,CAAC,CAhBF,EAiBP,CAAC,CAjBM,EAiBH,CAAC,CAjBE,EAiBC,CAAC,CAjBF,EAkBP,CAAC,CAlBM,EAkBH,CAAC,CAlBE,EAkBE,CAlBF,EAmBP,CAAC,CAnBM,EAmBF,CAnBE,EAmBE,CAnBF,EAqBP,CAAC,CArBM,EAqBF,CArBE,EAqBC,CAAC,CArBF,EAsBP,CAAC,CAtBM,EAsBF,CAtBE,EAsBE,CAtBF,EAuBN,CAvBM,EAuBF,CAvBE,EAuBE,CAvBF,EAwBN,CAxBM,EAwBF,CAxBE,EAwBC,CAAC,CAxBF,EA0BP,CAAC,CA1BM,EA0BH,CAAC,CA1BE,EA0BE,CA1BF,EA2BP,CAAC,CA3BM,EA2BH,CAAC,CA3BE,EA2BC,CAAC,CA3BF,EA4BN,CA5BM,EA4BH,CAAC,CA5BE,EA4BC,CAAC,CA5BF,EA6BN,CA7BM,EA6BH,CAAC,CA7BE,EA6BE,CA7BF,CAFiB;AAiC5BC,YAAAA,MAAM,EAAE,CACJ,CADI,EACD,CADC,EACE,CADF,EACK,CADL,EAEJ,CAFI,EAED,CAFC,EAEE,CAFF,EAEK,CAFL,EAGJ,CAHI,EAGD,CAHC,EAGE,CAHF,EAGK,CAHL,EAIJ,CAJI,EAID,CAJC,EAIE,CAJF,EAIK,CAJL,EAKJ,CALI,EAKD,CALC,EAKE,CALF,EAKK,CALL,EAMJ,CANI,EAMD,CANC,EAME,CANF,EAMK,CANL,EAOJ,CAPI,EAOD,CAPC,EAOE,CAPF,EAOK,CAPL,EAQJ,GARI,EAQC,GARD,EAQM,GARN,EAQW,CARX,EASJ,GATI,EASC,CATD,EASI,CATJ,EASO,CATP,EAUJ,CAVI,EAUD,GAVC,EAUI,CAVJ,EAUO,CAVP,EAWJ,CAXI,EAWD,CAXC,EAWE,GAXF,EAWO,CAXP,EAYJ,GAZI,EAYC,GAZD,EAYM,CAZN,EAYS,CAZT,EAaJ,CAbI,EAaD,GAbC,EAaI,GAbJ,EAaS,CAbT,EAcJ,GAdI,EAcC,CAdD,EAcI,GAdJ,EAcS,CAdT,EAeJ,GAfI,EAeC,GAfD,EAeM,CAfN,EAeS,CAfT,EAgBJ,CAhBI,EAgBD,GAhBC,EAgBI,GAhBJ,EAgBS,CAhBT,EAiBJ,GAjBI,EAiBC,CAjBD,EAiBI,GAjBJ,EAiBS,CAjBT,EAkBJ,GAlBI,EAkBC,GAlBD,EAkBM,CAlBN,EAkBS,CAlBT,EAmBJ,CAnBI,EAmBD,GAnBC,EAmBI,GAnBJ,EAmBS,CAnBT,EAoBJ,GApBI,EAoBC,CApBD,EAoBI,GApBJ,EAoBS,CApBT,EAqBJ,GArBI,EAqBC,GArBD,EAqBM,GArBN,EAqBW,CArBX,EAsBJ,GAtBI,EAsBC,GAtBD,EAsBM,GAtBN,EAsBW,CAtBX,EAuBJ,GAvBI,EAuBC,GAvBD,EAuBM,GAvBN,EAuBW,CAvBX,EAwBJ,GAxBI,EAwBC,GAxBD,EAwBM,GAxBN,EAwBW,CAxBX,CAjCoB;AA4D5BC,YAAAA,OAAO,EAAE,CACL,CADK,EACF,CADE,EACC,CADD,EAEL,CAFK,EAEF,CAFE,EAEC,CAFD,EAGL,CAHK,EAGF,CAHE,EAGC,CAHD,EAIL,CAJK,EAIF,CAJE,EAIC,CAJD,EAKL,CALK,EAKF,CALE,EAKC,CAAC,CALF,EAML,CANK,EAMF,CANE,EAMC,CAAC,CANF,EAOL,CAPK,EAOF,CAPE,EAOC,CAAC,CAPF,EAQL,CARK,EAQF,CARE,EAQC,CAAC,CARF,EASL,CATK,EASF,CATE,EASC,CATD,EAUL,CAVK,EAUF,CAVE,EAUC,CAVD,EAWL,CAXK,EAWF,CAXE,EAWC,CAXD,EAYL,CAZK,EAYF,CAZE,EAYC,CAZD,EAaL,CAAC,CAbI,EAaD,CAbC,EAaE,CAbF,EAcL,CAAC,CAdI,EAcD,CAdC,EAcE,CAdF,EAeL,CAAC,CAfI,EAeD,CAfC,EAeE,CAfF,EAgBL,CAAC,CAhBI,EAgBD,CAhBC,EAgBE,CAhBF,EAiBL,CAjBK,EAiBF,CAjBE,EAiBC,CAjBD,EAkBL,CAlBK,EAkBF,CAlBE,EAkBC,CAlBD,EAmBL,CAnBK,EAmBF,CAnBE,EAmBC,CAnBD,EAoBL,CApBK,EAoBF,CApBE,EAoBC,CApBD,EAqBL,CArBK,EAqBF,CAAC,CArBC,EAqBE,CArBF,EAsBL,CAtBK,EAsBF,CAAC,CAtBC,EAsBE,CAtBF,EAuBL,CAvBK,EAuBF,CAAC,CAvBC,EAuBE,CAvBF,EAwBL,CAxBK,EAwBF,CAAC,CAxBC,EAwBE,CAxBF,CA5DmB;AAsF5BC,YAAAA,UAAU,EAAE,CACR,IAAInB,GAAG,CAACoB,SAAR,CAAkBpB,GAAG,CAACqB,aAAJ,CAAkBC,aAApC,EAAmDtB,GAAG,CAACuB,MAAJ,CAAWC,MAA9D,CADQ,EAER,IAAIxB,GAAG,CAACoB,SAAR,CAAkBpB,GAAG,CAACqB,aAAJ,CAAkBI,UAApC,EAAgDzB,GAAG,CAACuB,MAAJ,CAAWG,OAA3D,CAFQ,EAGR,IAAI1B,GAAG,CAACoB,SAAR,CAAkBpB,GAAG,CAACqB,aAAJ,CAAkBM,WAApC,EAAiD3B,GAAG,CAACuB,MAAJ,CAAWC,MAA5D,CAHQ,CAtFgB;AA2F5BI,YAAAA,OAAO,EAAE,CACL,CADK,EACF,CADE,EACC,CADD,EACI,CADJ,EACO,CADP,EACU,CADV,EAEL,CAFK,EAEF,CAFE,EAEC,CAFD,EAEI,CAFJ,EAEO,CAFP,EAEU,CAFV,EAGL,CAHK,EAGF,CAHE,EAGC,EAHD,EAGK,EAHL,EAGS,CAHT,EAGY,EAHZ,EAIL,EAJK,EAID,EAJC,EAIG,EAJH,EAIO,EAJP,EAIW,EAJX,EAIe,EAJf,EAKL,EALK,EAKD,EALC,EAKG,EALH,EAKO,EALP,EAKW,EALX,EAKe,EALf,EAML,EANK,EAMD,EANC,EAMG,EANH,EAMO,EANP,EAMW,EANX,EAMe,EANf;AA3FmB,WAAhC;AAqGA,iBAAO7B,KAAK,CAAC8B,UAAN,CAAiBjB,GAAjB,EAAsBkB,SAAtB,EAAiC;AAAEC,YAAAA,eAAe,EAAE;AAAnB,WAAjC,CAAP;AACH;;AAzHsC,O;;;;;iBAGb,I","sourcesContent":["\r\nimport { _decorator, Component, Node, MeshRenderer, Mesh, misc, utils, primitives, Primitive, gfx, Color } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n@ccclass('DynamicMesh')\r\nexport class DynamicMesh extends Component {\r\n\r\n    @property(MeshRenderer)\r\n    mr: MeshRenderer | null = null;\r\n\r\n    start () {\r\n    }\r\n\r\n    onBtnChangeMesh() {\r\n        console.log('auto generate dynamic mesh');\r\n        if (null == this.mr) {\r\n            return;\r\n        }\r\n        let mesh = this.mr.mesh;\r\n        mesh?.reset(this.genMesh());\r\n        this.mr.mesh = mesh;\r\n    }\r\n\r\n    genMesh(): Mesh.ICreateInfo {\r\n        let geo: primitives.IGeometry = {\r\n            primitiveMode: gfx.PrimitiveMode.TRIANGLE_STRIP,\r\n            positions: [\r\n                -1,  1,  1,\r\n                -1, -1,  1,\r\n                 1, -1,  1,\r\n                 1,  1,  1,\r\n\r\n                 1,  1, -1,\r\n                 1, -1, -1,\r\n                -1, -1, -1,\r\n                -1,  1, -1,\r\n\r\n                 1,  1,  1,\r\n                 1, -1,  1,\r\n                 1, -1, -1,\r\n                 1,  1, -1,\r\n\r\n                -1,  1, -1,\r\n                -1, -1, -1,\r\n                -1, -1,  1,\r\n                -1,  1,  1,\r\n\r\n                -1,  1, -1,\r\n                -1,  1,  1,\r\n                 1,  1,  1,\r\n                 1,  1, -1,\r\n\r\n                -1, -1,  1,\r\n                -1, -1, -1,\r\n                 1, -1, -1,\r\n                 1, -1,  1,\r\n            ],\r\n            colors: [\r\n                1, 0, 0, 1,\r\n                0, 1, 0, 1,\r\n                0, 0, 1, 1,\r\n                1, 1, 1, 1,\r\n                1, 1, 0, 1,\r\n                0, 1, 1, 1,\r\n                1, 0, 1, 1,\r\n                0.5, 0.5, 0.5, 1,\r\n                0.5, 0, 0, 1,\r\n                0, 0.5, 0, 1,\r\n                0, 0, 0.5, 1,\r\n                0.5, 0.5, 0, 1,\r\n                0, 0.5, 0.5, 1,\r\n                0.5, 0, 0.5, 1,\r\n                0.2, 0.2, 0, 1,\r\n                0, 0.2, 0.2, 1,\r\n                0.2, 0, 0.2, 1,\r\n                0.5, 0.8, 0, 1,\r\n                0, 0.5, 0.8, 1,\r\n                0.8, 0, 0.5, 1,\r\n                0.7, 0.2, 0.5, 1,\r\n                0.7, 0.5, 0.2, 1,\r\n                0.2, 0.5, 0.7, 1,\r\n                0.2, 0.7, 0.5, 1,\r\n\r\n            ],\r\n            normals: [\r\n                0, 0, 1,\r\n                0, 0, 1,\r\n                0, 0, 1,\r\n                0, 0, 1,\r\n                0, 0, -1,\r\n                0, 0, -1,\r\n                0, 0, -1,\r\n                0, 0, -1,\r\n                1, 0, 0,\r\n                1, 0, 0,\r\n                1, 0, 0,\r\n                1, 0, 0,\r\n                -1, 0, 0,\r\n                -1, 0, 0,\r\n                -1, 0, 0,\r\n                -1, 0, 0,\r\n                0, 1, 0,\r\n                0, 1, 0,\r\n                0, 1, 0,\r\n                0, 1, 0,\r\n                0, -1, 0,\r\n                0, -1, 0,\r\n                0, -1, 0,\r\n                0, -1, 0,\r\n            ],\r\n            attributes: [\r\n                new gfx.Attribute(gfx.AttributeName.ATTR_POSITION, gfx.Format.RGB32F),\r\n                new gfx.Attribute(gfx.AttributeName.ATTR_COLOR, gfx.Format.RGBA32F),\r\n                new gfx.Attribute(gfx.AttributeName.ATTR_NORMAL, gfx.Format.RGB32F),\r\n            ],\r\n            indices: [\r\n                0, 1, 2, 3, 0, 2,\r\n                4, 5, 6, 7, 4, 6,\r\n                8, 9, 10, 11, 8, 10,\r\n                12, 13, 14, 15, 12, 14,\r\n                16, 17, 18, 19, 16, 18,\r\n                20, 21, 22, 23, 20, 22\r\n            ],\r\n        };\r\n\r\n        return utils.createMesh(geo, undefined, { calculateBounds: false });\r\n    }\r\n\r\n}\r\n\r\n"]}